---
import BaseLayout from "../layouts/BaseLayout.astro";

const ctaNote = "Free during early access";
---

<BaseLayout
  title="AlphaMail — Weekly goal check-ins by email"
  description="AlphaMail is an AI-powered goal tracking system that keeps you accountable with weekly email check-ins."
>
  <div class="w-full">
    <div class="w-full max-w-xl mx-auto px-6 sm:px-8 py-12">
      <section class="py-16 sm:py-24">
        <div class="max-w-2xl space-y-6 text-center mx-auto">
          <h1 class="text-4xl sm:text-5xl font-['Song_Myung'] tracking-tight">
            AlphaMail
          </h1>
          <p class="text-lg sm:text-xl text-neutral-600 max-w-xl mx-auto">
            Meet Alpha — your AI accountability partner. Set a weekly goal, get a Sunday check-in from <span class="font-medium text-neutral-800">alpha@bealphamail.com</span>, reply with your progress, and repeat.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 pt-2 justify-center items-center">
            <a
              id="cta-btn"
              href="/signup"
              class="group px-6 h-12 flex items-center justify-center text-base sm:text-lg bg-gradient-to-t from-blue-600 to-blue-500 text-white rounded-full shadow-md hover:shadow-lg hover:scale-[102%] active:scale-[98%] transition-all"
            >
              <span id="cta-text">Start your first goal</span>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-5 w-5 ml-2 group-hover:translate-x-1 transition-transform"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
                />
              </svg>
            </a>
            <p id="cta-note" class="text-neutral-500 self-center">{ctaNote}</p>
          </div>
        </div>
      </section>
    </div>
  </div>
</BaseLayout>

<script>
  import { supabase } from "../lib/supabase";

  async function updateCTA() {
    const { data: { user } } = await supabase.auth.getUser();
    
    const ctaBtn = document.getElementById("cta-btn") as HTMLAnchorElement;
    const ctaText = document.getElementById("cta-text");
    const ctaNote = document.getElementById("cta-note");

    if (user) {
      // User is logged in
      if (ctaBtn) ctaBtn.href = "/account";
      if (ctaText) ctaText.textContent = "Go to your account";
      if (ctaNote) ctaNote.textContent = "Welcome back!";
    }
  }

  updateCTA();
</script>
