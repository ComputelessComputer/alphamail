---
import BaseLayout from "../layouts/BaseLayout.astro";

const ctaNote = "Free during early access";
---

<BaseLayout
  title="AlphaMail — Weekly goal check-ins by email"
  description="AlphaMail is an AI-powered goal tracking system that keeps you accountable with weekly email check-ins."
>
  <div class="w-full">
    <div class="w-full max-w-2xl mx-auto px-6 sm:px-8 py-12">
      <!-- Headline -->
      <div class="text-center mb-10">
        <h1 class="text-4xl sm:text-5xl font-['Song_Myung'] tracking-tight mb-4">
          AlphaMail
        </h1>
        <p class="text-lg sm:text-xl text-neutral-600 max-w-lg mx-auto">
          Your AI accountability partner. Set a goal, get a Sunday check-in, reply with progress, repeat.
        </p>
      </div>

      <!-- Mock Email Client -->
      <div class="rounded-xl bg-white/80 backdrop-blur-xl shadow-2xl border border-white/20 ring-1 ring-black/5 overflow-hidden flex flex-col w-full text-left mb-10">
        <!-- Window Chrome / Toolbar -->
        <div class="h-12 bg-gradient-to-b from-[#f6f6f6] to-[#e8e8e8] border-b border-[#d1d1d1] flex items-center px-4 shadow-[0_1px_0_rgba(255,255,255,0.5)_inset]">
          <div class="flex gap-2">
            <div class="w-3 h-3 rounded-full bg-[#FF5F57] border border-[#E09E3E]/30 shadow-sm"></div>
            <div class="w-3 h-3 rounded-full bg-[#FEBC2E] border border-[#DFA023]/30 shadow-sm"></div>
            <div class="w-3 h-3 rounded-full bg-[#28C840] border border-[#1AAB29]/30 shadow-sm"></div>
          </div>
        </div>

        <!-- Email Metadata Fields -->
        <div class="flex flex-col bg-white">
          <div class="flex items-center px-4 py-2 border-b border-[#e5e5e5]">
            <span class="text-neutral-400 w-16 text-left mr-3 text-sm font-medium">To:</span>
            <span class="text-neutral-900 text-sm bg-blue-100/50 px-2 py-0.5 rounded text-blue-800">You</span>
          </div>
          <div class="flex items-center px-4 py-2 border-b border-[#e5e5e5]">
            <span class="text-neutral-400 w-16 text-left mr-3 text-sm font-medium">Subject:</span>
            <span class="text-neutral-900 text-sm font-medium">Sunday check-in: How's your goal going?</span>
          </div>
          <div class="flex items-center px-4 py-2 border-b border-[#e5e5e5]">
            <span class="text-neutral-400 w-16 text-left mr-3 text-sm font-medium">From:</span>
            <span class="text-neutral-500 text-sm">Alpha &lt;alpha@bealphamail.com&gt;</span>
          </div>
        </div>

        <!-- Email Body -->
        <div class="p-6 sm:p-8 bg-white text-neutral-800 font-[Helvetica] text-base leading-relaxed space-y-4">
          <p>Hi there,</p>
          <p>It's Sunday — time for your weekly check-in!</p>
          <p>Your goal this week was:</p>
          <div class="bg-blue-50 border-l-4 border-blue-400 px-4 py-3 rounded-r-lg">
            <p class="font-medium text-neutral-900">Ship the AlphaMail landing page</p>
          </div>
          <p>How did it go? Reply to this email with:</p>
          <ul class="list-disc list-inside text-neutral-600 space-y-1 pl-2">
            <li>What you accomplished</li>
            <li>What got in the way (if anything)</li>
            <li>Your goal for next week</li>
          </ul>
          <div class="pt-4 text-neutral-400 text-sm">
            <p>— Alpha</p>
          </div>
        </div>
      </div>

      <!-- CTA -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
        <a
          id="cta-btn"
          href="/signup"
          class="group px-6 h-12 flex items-center justify-center text-base sm:text-lg bg-gradient-to-t from-blue-600 to-blue-500 text-white rounded-full shadow-md hover:shadow-lg hover:scale-[102%] active:scale-[98%] transition-all"
        >
          <span id="cta-text">Start your first goal</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="h-5 w-5 ml-2 group-hover:translate-x-1 transition-transform"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
            />
          </svg>
        </a>
        <p id="cta-note" class="text-neutral-500 self-center">{ctaNote}</p>
      </div>
    </div>
  </div>
</BaseLayout>

<script>
  import { supabase } from "../lib/supabase";

  async function updateCTA() {
    const { data: { user } } = await supabase.auth.getUser();
    
    const ctaBtn = document.getElementById("cta-btn") as HTMLAnchorElement;
    const ctaText = document.getElementById("cta-text");
    const ctaNote = document.getElementById("cta-note");

    if (user) {
      // User is logged in
      if (ctaBtn) ctaBtn.href = "/account";
      if (ctaText) ctaText.textContent = "Go to your account";
      if (ctaNote) ctaNote.textContent = "Welcome back!";
    }
  }

  updateCTA();
</script>
